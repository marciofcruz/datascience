2 + 2
R.version()
r.version()
R.version
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
source('C:/Projetos/github.com/datascience/fia/20210518/aula 20210518.R')
StartDate < as.Date("2020/2/28")
StartDate <- as.Date("2020/2/28")
StopDate < as.Date("2020/3/1")
StopDate <- as.Date("2020/3/1")
StopDate - StartDate
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
summary(cars)
teste <- c(1,2,3,4)
teste <- c(1,2,3,4)
teste
source('C:/Projetos/github.com/datascience/fia/20210622/aula regressao linear multipla.R', encoding = 'UTF-8', echo=TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
library(ggplot2)
library(GGally)
# Importar Base Dados -----------------------------------------------------
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
dados_lim_cred  <- read_excel("doc/Regressão linear múltipla.xlsx",sheet="Limite_Credito (1)" ) #Função que lê o arquivo xls e salva em uma base de dados R
dados_lim_cred
#Verificar variáveis
names(dados_lim_cred)
# Matriz de Gráfico de Dispersão
#Matriz de Scatter Plot
ggpairs(dados_lim_cred, title="correlogram with ggpairs()")
#Regressão Linear Múltipla
#Modelo de Regressão Linear Múltipla
regressao <- lm(data=dados_lim_cred, LimitedoChequeEspecial ~ Idade+Salario+LimitedeCreditoImediato)
summary(regressao)
#Modelo anterior sem Idade
regressao_1 <- lm(data=dados_lim_cred, LimitedoChequeEspecial ~ Salario+LimitedeCreditoImediato)
summary(regressao_1)
source('C:/Projetos/github.com/datascience/fia/20210622/aula regressao linear simples.R', encoding = 'UTF-8', echo=TRUE)
source('C:/Projetos/github.com/datascience/fia/20210622/aula regressao linear simples.R', encoding = 'UTF-8', echo=TRUE)
source('C:/Projetos/github.com/datascience/fia/20210622/aula regressao linear simples.R', encoding = 'UTF-8', echo=TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
# Importar Base Dados -----------------------------------------------------
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
names(imobiliario)
head(imobiliario)
#Análise Exploratória
summary(imobiliario)
# a) Faça o gráfico de dispersão entre as variáveis Distancia_metro_Km e Mil_reais_m2. Existe relação entre preço do imóvel e distância para o metrô? É positiva ou negativa?
plot(imobiliario$Distancia_metro_Km, imobiliario$Mil_reais_m2)
# plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
abline(lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km), col='blue')
# b) Calcule o coeficiente de correlação linear entre as duas variáveis e interprete o coeficiente.
cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
# c) Por meio do modelo de regressão linear simples, teste se existe relação linear entre as variáveis considerando 90% de confiança.
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
# e) Apresente a equação do modelo estimada.
x <- 1
y <- 18.8154 - 7.2166*x
print(y)
# f) Estime o valor do m2 do imóvel caso o cliente desejasse morar a 1 km do metrô.
# c) Por meio do modelo de regressão linear simples, teste se existe relação linear entre as variáveis considerando 90% de confiança.
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
# Importar Base Dados -----------------------------------------------------
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
names(imobiliario)
head(imobiliario)
#Análise Exploratória
summary(imobiliario)
# a) Faça o gráfico de dispersão entre as variáveis Distancia_metro_Km e Mil_reais_m2. Existe relação entre preço do imóvel e distância para o metrô? É positiva ou negativa?
plot(imobiliario$Distancia_metro_Km, imobiliario$Mil_reais_m2)
# plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
abline(lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km), col='blue')
# b) Calcule o coeficiente de correlação linear entre as duas variáveis e interprete o coeficiente.
cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
knitr::opts_chunk$set(echo = TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
options(scipen=999)
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
names(imobiliario)
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
summary(imobiliario)
summary(imobiliario)
```{r}
```{r}
summary(imobiliario)
plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
correlacao = cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
correlacao = cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
abline(lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km), col='blue')
---
title: "Case Predição Preço de Imóvel - FIA"
author: "Marcio Fernandes Cruz"
date: "27/06/2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
options(scipen=999)
options(scipen=999)
## Case
![Predição de preços de imóveis - Regressão Linear Simples](img/casepredicaoprecoimovel.jpg)
```{r echo = F}
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
# names(imobiliario)
```{r echo = F}
---
title: "Case Predição Preço de Imóvel - FIA"
author: "Marcio Fernandes Cruz"
date: "27/06/2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
options(scipen=999)
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
---
title: "Case Predição Preço de Imóvel - FIA"
author: "Marcio Fernandes Cruz"
date: "27/06/2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# inicialização -----------------------------------------------------------
wd <- Sys.getenv("RWD")
if (!file.exists(wd)) {
stop(paste("O diretorio definido na variavel de ambiente RWD nao foi encontrado",wd, sep="="))
}
setwd(wd)
getwd()
rm(list = ls())
options(scipen=999)
options(scipen=999)
## Case
![Predição de preços de imóveis - Regressão Linear Simples](img/casepredicaoprecoimovel.jpg)
```{r echo = F}
library(readxl) #Avisar o R que utilizará este pacote. Deve-se avisar toda vez que abrir o R
imobiliario <- read_excel("doc/Regressão linear simples.xlsx",sheet="Imobiliario" ) #Função que lê o arquivo xls e salva em uma base de dados R
#Verificar variáveis
# names(imobiliario)
# summary(imobiliario)
### Respostas
#### a) Faça o gráfico de dispersão entre as veriáveis Distância_metro_Km e Mil_reais_m2. Existe relaçã entre preço do imóvel e distância para o metrô? É positiva ou negativa?
```{r echo = F}
plot(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2, ylab="Preço (Mil R$/m2)", xlab="Distância (km)", col='darkturquoise', xlim = c(0,3), ylim = c(0,20))
abline(lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km), col='blue')
correlacao = cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
correlacao = cor(imobiliario$ Distancia_metro_Km, imobiliario$Mil_reais_m2)
**Valor da Correlação:**
**Interpretação:** Existe uma correlação forte e negativa (r = `r round(correlacao,4)`) entre as variáveis de distância ao metrô e preço por metro quadrado.
**Valor da Correlação:**
**Interpretação:** Existe uma correlação forte e negativa (r = `r round(correlacao,4)`) entre as variáveis de distância ao metrô e preço por metro quadrado.
'
'
'
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
summary(regressao)
```{r}
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
```{r}
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
regressao <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
summary(regressao)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 + Distancia_metro_Km)
summary(regressao.bo_b1)
regressao.b1 <- lm(data=imobiliario, Mil_reais_m2 ~ 0+ Distancia_metro_Km)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 + Distancia_metro_Km)
summary(regressao.bo_b1)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 + Distancia_metro_Km)
summary(regressao.bo_b1)$p_value
```{r echo = F}
```{r echo = F}
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km)
summary(regressao.bo_b1)
names(summary(regressao.bo_b1))
summary(regressao.bo_b1)$coefficients
names(summary(regressao.bo_b1)$coefficients)
summary(regressao.bo_b1)$coefficients
summary(regressao.bo_b1)$coefficients
summary(regressao.bo_b1)$coefficients$Distancia_metro_km
regressao.bo_b1)$coefficients$Distancia_metro_km
regressao.bo_b1$coefficients$Distancia_metro_km
summary(regressao.bo_b1)$coefficients
summary(regressao.bo_b1)$coefficients[1]
summary(regressao.bo_b1)$coefficients[2]
summary(regressao.bo_b1)$coefficients[1,2]
summary(regressao.bo_b1)$coefficients[1,1]
summary(regressao.bo_b1)$coefficients
summary(regressao.bo_b1)
regressao.bo_b1 <- lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km)
summary(regressao.bo_b1)
```{r }
summary(regressao.b1)
regressao.b1 <- lm(data=imobiliario, Mil_reais_m2 ~ Distancia_metro_Km)
summary(regressao.b1)
### f) Estime o valor do m2 do imóvel caso o cliente desejasse morar a 1 km do metrô.
x <- 1
y = 18.8154 - 7.2166 * x
### g) Para este cliente que deseja morar a 1km do metrô, estimo o valor a ser pago em um apartamento de 70 m2
format(round(y, 2), nsmall = 2)
valor_pago.70m2_1km <- 70 * valor.distancia_1km
valor.distancia_1km <- 18.8154 - 7.2166 * x
valor_pago.70m2_1km <- 70 * valor.distancia_1km
valor_pago.70m2_1km <- 70 * valor.distancia_1km
#Verificar variáveis
# names(imobiliario)
summary(imobiliario)
#Verificar variáveis
names(imobiliario)
valor_pago.70m2_1km <- 70 * valor.distancia_1km * 1000
valor_pago.70m2_1km <- 70 * valor.distancia_1km * 1000
### g) Para este cliente que deseja morar a 1km do metrô, estimo o valor a ser pago em um apartamento de 70 m2
```{r echo = F}
valor_pago.70m2_1km <- 70 * valor.distancia_1km * 1000
```
O valor estimado de um apartametno de 70m2 a  a 1 Km do metrô é R$ `r format(round(valor_pago.70m2_1km, 2), nsmall = 2)`
